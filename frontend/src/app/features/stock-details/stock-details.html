<app-header></app-header>
<main *ngIf="stockDetail$ | async as stock" class="max-w-[1600px] mx-auto p-4 md:p-8 bg-slate-50 space-y-8">

  <header class="bg-white/80 backdrop-blur-md border-b border-slate-200 -mx-4 md:-mx-8 px-8 py-4 flex flex-wrap justify-between items-center gap-6 sticky top-0 z-10">
    <div class="flex items-center gap-4">
        <img [src]="stock.logourl" class="w-12 h-12 object-contain rounded-lg border border-slate-100 p-1 bg-white">
        <div>
            <h1 class="text-2xl font-black text-slate-900 leading-none">{{stock.symbol}}</h1>
            <p class="text-[10px] text-slate-500 font-bold uppercase tracking-widest mt-1">{{stock.longName}}</p>
        </div>
    </div>
    <div class="flex items-center gap-8">
        <div class="text-right">
            <p class="text-[10px] text-slate-400 font-bold uppercase">Preço Atual</p>
            <p class="text-2xl font-mono font-black text-slate-900 leading-none">
              {{ stock.regularMarketPrice}}
            </p>
        </div>
        <div class="text-right border-l border-slate-200 pl-8">
            <p class="text-[10px] text-slate-400 font-bold uppercase">Variação (Dia)</p>
            <p [ngClass]="{
              'text-xl font-mono font-bold text-emerald-500': stock.regularMarketChangePercent > 0,
              'text-xl font-mono font-bold text-red-500': stock.regularMarketChangePercent < 0
            }">
              {{ stock.regularMarketChangePercent > 0 ? '+' : '' }}{{stock.regularMarketChangePercent.toFixed(2)}}%
            </p>
        </div>
        <button class="bg-slate-900 text-white px-6 py-2 rounded-lg text-sm font-bold hover:bg-slate-800 transition-all shadow-lg shadow-slate-200">
            Adicionar à Carteira
        </button>
    </div>
  </header>

  <section>
    <div class="flex items-center gap-2 mb-4">
        <h2 class="text-sm font-black text-slate-400 uppercase tracking-[0.2em]">Resumo do Ativo</h2>
        <div class="h-px bg-slate-200 flex-1"></div>
    </div>
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4">
      <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
        <span class="text-[10px] text-slate-400 font-bold uppercase block mb-1">P/L (Preço/Lucro)</span>
        <span class="text-xl font-mono font-black text-slate-800">{{ stock.priceEarnings?.toFixed(2) || 'N/A' }}</span>
      </div>
      
      <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
        <span class="text-[10px] text-slate-400 font-bold uppercase block mb-1">LPA (Lucro p/ Ação)</span>
        <span class="text-xl font-mono font-black text-slate-800">{{ stock.earningsPerShare?.toFixed(2) || 'N/A' }}</span>
      </div>

      <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
        <span class="text-[10px] text-slate-400 font-bold uppercase block mb-1">Mkt Cap</span>
        <span class="text-xl font-mono font-black text-slate-800">
          R$ {{ (stock.marketCap / 1000000000).toFixed(2) }}B
        </span>
      </div>

      <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
        <span class="text-[10px] text-slate-400 font-bold uppercase block mb-1">Volume Diário</span>
        <span class="text-xl font-mono font-black text-slate-800">{{ stock.regularMarketVolume }}</span>
      </div>

      <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
        <span class="text-[10px] text-slate-400 font-bold uppercase block mb-1">Fechamento Ant.</span>
        <span class="text-xl font-mono font-black text-slate-500">R$ {{ stock.regularMarketPreviousClose }}</span>
      </div>
    </div>
  </section>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    
    <div class="lg:col-span-2 space-y-6">
        <section class="bg-white p-8 rounded-2xl border border-slate-200">
            <h3 class="font-black text-slate-900 mb-4 uppercase text-xs tracking-widest">Sobre a {{ stock.symbol }}</h3>
            <p class="text-slate-600 text-sm leading-relaxed mb-8">
              {{ stock.summaryProfile.longBusinessSummary }}
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 pt-6 border-t border-slate-100">
                <div>
                    <span class="text-[10px] text-slate-400 font-bold uppercase block">Setor</span>
                    <span class="text-sm font-bold text-slate-700">{{ stock.summaryProfile.sector }}</span>
                </div>
                <div>
                    <span class="text-[10px] text-slate-400 font-bold uppercase block">Indústria</span>
                    <span class="text-sm font-bold text-slate-700">{{ stock.summaryProfile.industry }}</span>
                </div>
                <div>
                    <span class="text-[10px] text-slate-400 font-bold uppercase block">Website</span>
                    <a [href]="stock.summaryProfile.website" target="_blank" class="text-sm font-bold text-blue-600 hover:underline">
                      {{ stock.summaryProfile.website.replace('https://', '') }}
                    </a>
                </div>
            </div>
        </section>
    </div>

    <div class="space-y-6">
        <section class="bg-slate-900 p-6 rounded-2xl text-white">
            <h3 class="font-bold text-slate-400 mb-6 text-xs uppercase tracking-widest">Performance (52 Semanas)</h3>
            <div class="space-y-6">
                <div class="flex justify-between items-center">
                    <div>
                        <span class="text-[10px] text-slate-500 font-bold uppercase">Mínima</span>
                        <p class="text-lg font-mono font-bold text-red-400">R$ {{ stock.fiftyTwoWeekLow }}</p>
                    </div>
                    <div class="text-right">
                        <span class="text-[10px] text-slate-500 font-bold uppercase">Máxima</span>
                        <p class="text-lg font-mono font-bold text-emerald-400">R$ {{ stock.fiftyTwoWeekHigh }}</p>
                    </div>
                </div>
                
                <div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden">
                  <div class="bg-blue-500 h-full" 
                    [style.width.%]="((stock.regularMarketPrice - stock.fiftyTwoWeekLow) / (stock.fiftyTwoWeekHigh - stock.fiftyTwoWeekLow)) * 100">
                  </div>
                </div>
            </div>
        </section>

        <section class="bg-white p-6 rounded-2xl border border-slate-200">
          <h3 class="font-bold text-slate-400 mb-6 text-xs uppercase tracking-widest">Variação do Dia</h3>
          <div class="space-y-4">
              <div class="flex justify-between text-sm">
                  <span class="text-slate-500">Mínima</span>
                  <span class="font-mono font-bold">R$ {{ stock.regularMarketDayLow }}</span>
              </div>
              <div class="flex justify-between text-sm">
                  <span class="text-slate-500">Abertura</span>
                  <span class="font-mono font-bold">R$ {{ stock.regularMarketOpen }}</span>
              </div>
              <div class="flex justify-between text-sm">
                  <span class="text-slate-500">Máxima</span>
                  <span class="font-mono font-bold">R$ {{ stock.regularMarketDayHigh }}</span>
              </div>
          </div>
        </section>

        <div class="bg-blue-50 p-4 rounded-xl border border-blue-100">
          <div class="flex items-center gap-3">
            <div class="text-blue-600">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
            </div>
            <div>
              <p class="text-[10px] text-blue-400 font-bold uppercase">Sede</p>
              <p class="text-xs font-bold text-blue-900">{{ stock.summaryProfile.city }}, {{ stock.summaryProfile.state }} - {{ stock.summaryProfile.country }}</p>
            </div>
          </div>
        </div>
    </div>
  </div>
</main>
<app-footer></app-footer>